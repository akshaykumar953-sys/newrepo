from fastapi import APIRouter, UploadFile, File
from app.engines.oracle.parser import parse_awr
from app.engines.oracle.scorer import score_awr

router = APIRouter()

@router.post("/oracle")
async def analyze_oracle(file: UploadFile = File(...)):
    content = await file.read()
    text = content.decode(errors="ignore")

    features = parse_awr(text)
    result = score_awr(features)

    return result
